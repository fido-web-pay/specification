<!DOCTYPE html><html><head>
<meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1">
<link rel="icon" href="images/favicon.png" sizes="192x192">
<title>FIDO Web Pay</title><style type="text/css">
.header {font-size:1.6em;margin:1em 0 0.8em 0}
.step {font-size:1.2em;margin-top:1.5em;margin-bottom:0.6em}
.para {margin-top: 0.8em}
.actor {color:darkgreen;font-weight:500}
.msg {font-weight:500}
.comment {padding:0.5em 1em;margin-top:1.5em;display:inline-block;background-color:#fafffa}
.box {box-shadow: 0.2em 0.2em 0.2em #d0d0d0;border-width:1px;border-style:solid;border-color:black}
.numbox {border-width:1pt;border-style:solid;border-color:black;border-radius:0.3em;display:inline-block;margin-right:0.6em;padding:0 3pt}
.tftable {border-collapse:collapse;box-shadow:0.2em 0.2em 0.2em #d0d0d0;margin:0.6em 0 1em 0}
.tftable td {background-color: #fffdf2;padding: 0.4em 0.5em;border-width: 1px;border-style: solid; border-color: black}
.tftable th {font-weight: normal;padding: 0.4em 0.5em;background-color: #f8f8f8;text-align: center;border-width: 1px;border-style: solid; border-color: black}
.json {word-break:break-all;background-color:#f8f8f8;padding:1em;border-width:1px;border-style:solid;border-color:#a9a9a9;box-shadow:0.3em 0.3em 0.3em #d0d0d0}
body {margin:1em;font-size:10pt;font-family:Roboto,sans-serif;background-color:white}
code {font-family:"Noto Mono",monospace;color:maroon;font-weight:bolder}
kbd {font-family: "Noto Mono",monospace;font-weight:bolder}
pre {font-family:"Noto Mono",monospace;margin: 0.8em 0 1em 0;padding:0.6em 1em;overflow-x:auto;background-color: #f8f8f8}
ul {margin: 0;padding-left:2em}
li {margin-top:0.3em}
a {color:#4366bf;text-decoration:none;font-weight:500;white-space:nowrap}
</style>
</head>
<body>
  <img style="max-width:50%" src="images/fwp.svg" alt="logo" title="FWP logotype">
  <div id="introduction" class="header">Introduction</div>
  <div>
    <a href="https://www.emvco.com/" title="EMVCo Site">EMV&reg;<img src="images/xtl.svg" alt="link"></a> represents
    the current &quot;Gold Standard&quot; for <i>secure and convenient payments</i>
    in the physical world.
  </div>
  <div class="para">
    This document describes FIDO&reg; Web Pay (FWP), which is a <a href="#implementationoptions">Web-adapted</a> version of EMV,
    combining the technology underpinning <a href="https://fidoalliance.org/fido2/"
                             title="FIDO2 Technology">FIDO2<img src="images/xtl.svg" alt="link"></a>
    with the W3C
    <a href="https://www.w3.org/TR/payment-request/"
       title="PaymentRequest">PaymentRequest<img src="images/xtl.svg" alt="link"></a> API and
    a browser-resident (<i>built-in</i>) payment application.
  </div>
  <div class="para">
    Through an extension to EMV, FWP can be used with virtually to any <i>account-based payment system</i>,
    including the eurozone's
    <a href="https://www.europeanpaymentscouncil.eu/"
       title="European Payments Council">SEPA Instant<img src="images/xtl.svg" alt="link"></a>.
  </div>
  <div class="para">
     Apart from obvious data format differences (JSON/JavaScript versus ISO7816),
     the primary technical enhancement to EMV, is that the FWP client
     <i>encrypts user-authorizations</i>, enabling the following subgoals:
  </div>
  <ul>
    <li>
      Obviate the need for <i>tokenization services</i>.
    </li>
    <li>
      Limit the amount of personally identifiable information (PII) shared
      with <i>third parties</i>, to the name of the user's bank.
      This is presumably compliant with
      <a href="https://www.pcisecuritystandards.org"
         title="PCI Site">PCI<img src="images/xtl.svg" alt="link"></a>
      requirements as well as with <a href="https://gdprinfo.eu/"
title="GDPR Site">GDPR<img src="images/xtl.svg" alt="link"></a>.
    </li>
    <li>
      Separate account numbers from issuer (bank branch) identifiers.
      The latter should preferably be expressed as <a href="#servicediscovery">service URLs</a>,
      potentially eliminating 
      <i>externally managed databases</i> holding issuer payment processor end-points.
    </li>
  </ul>
  <div id="scope" class="header">
    Scope
  </div>
  <div>
    Note that FWP is not a payment system, it is a <i>payment authorization</i> scheme,
    exclusively dealing with the <i>user's</i> part of the payment process.
    That is, <i>the backend infrastructure and associated APIs are out of scope for this specification</i>.
   </div>
  <div class="para">
    However, to guide implementers, this document outlines
    a sample infrastructure at a &quot;conceptual&quot; level.
    Note though that regardless of the backend design, FWP assertions
    must (due to the EMV <i>end-to-end security model</i>),
    always be routed back to the designated issuer &quot;verbatim&quot;
    (together with other required data) in order to initiate a payment transaction.
  </div>
  <div class="para">
    It is assumed that <i>at this stage in time</i>,
    backend infrastructures will be <i>independently defined</i> by each payment network
    rather than becoming a unified standard.  See also <a href="#integration">Integration</a>.
  </div>
  <div id="terminology" class="header">
    Terminology
  </div>
  <div>
    Throughout the rest of this document, actor names are
    written as <span class="actor">Name</span>.
    The <span class="actor">Browser</span> actor is in this specification
    considered to be equivalent to &quot;User Agent&quot;.
    A <span class="actor">PSP</span> (Payment System Provider) is in this specification
    denoting any service or network acting as a <i>trusted intermediary</i> between
    a <span class="actor">Merchant</span> and an <span class="actor">Issuer</span>.
    In FWP objects, <span class="actor">Merchant</span> is referred to as &quot;payee&quot;.
  </div>
  <div id="credentials" class="header">
    Credential Database
  </div>
  <div>
    The steps outlined in <a href="#operation">Detailed Operation</a>
    depend on that the <span class="actor">User</span> already have received
    one or more FWP credentials
    (&quot;Virtual Cards&quot;) in an <a href="#enrollment">Enrollment</a> process.
    FWP credentials are stored in a local database, where each entry is
    supposed to contain the following attributes:
</div>
  <table class="tftable">
    <tr>
      <th>Attribute</th>
      <th>Data</th>
    </tr>
    <tr>
      <td><code>keyHandle</code></td>
      <td>
        <i>Locally created</i> identifier to a
        <span class="actor">User</span> specific (<i>unique</i>) FIDO key for
        FWP <a href="#seq-4.4">signatures</a>.
      </td>
    </tr>
    <tr>
      <td><code>publicKey</code></td>
      <td>
        <i>Locally created</i> public key matching the private key
        associated with <code>keyHandle</code>.
      </td>
    </tr>
    <tr>
      <td><code>credentialId</code></td>
      <td>
        Unique credential identifier, typically a serial number.
      </td>
    </tr>
    <tr>
      <td><code>signatureAlgorithm</code></td>
      <td>
        Signature algorithm for FWP <a href="#seq-4.4">signatures</a>.
      </td>
    </tr>
    <tr>
      <td><code>encryptionKey</code></td>
      <td>
        <span class="actor">Issuer</span> specific (<i>shared</i>) public key
        for FWP <a href="#seq-4.5">encryption</a>.
      </td>
    </tr>
    <tr>
      <td><code>contentEncryptionAlgorithm</code></td>
      <td>
        JOSE-compliant content encryption algorithm for
        FWP <a href="#seq-4.5">encryption</a>.
      </td>
    </tr>
    <tr>
      <td><code>keyEncryptionAlgorithm</code></td>
      <td>
        JOSE-compliant key encryption algorithm for
        FWP <a href="#seq-4.5">encryption</a>.
      </td>
    </tr>
    <tr>
      <td><code>accountId</code></td>
      <td>
        Account identifier associated with the credential.
      </td>
    </tr>
    <tr>
      <td><code>paymentMethod</code></td>
      <td>
        URL holding the FWP method for a particular payment network.
      </td>
    </tr>
    <tr>
      <td><code>issuerId</code></td>
      <td>
        Bank Identification Number (BIN) or URL associated with
        the <span class="actor">Issuer</span>.
        The exact definition is specific for each <code>paymentMethod</code>.
        See also <a href="#servicediscovery">Service Discovery</a>.
      </td>
    </tr>
    <tr>
      <td><code>image</code></td>
      <td>
        SVG image identifying the payment credential for
        the <span class="actor">User</span>.
      </td>
    </tr>
  </table>
  <div>
    Note: how attributes are represented in the credential database is <i>implementation specific</i>.
    Public keys may for example be stored in the X.509, JWK, or COSE format.
  </div>
  <div id="keyprotection" class="comment box">
    Through the use of a dedicated credential database,
    associated FIDO keys can be freely used by the FWP implementation,
    while remaining <i>invisible</i> and <i>protected</i> from
    access by all parties but their respective <span class="actor">Issuer</span>.
  </div> 
  <div id="enrollment" class="header">
    Enrollment
  </div>
  <div>
    The exact enrollment process is yet to be defined; the assumption is that it
    could be accomplished by extending the existing W3C
    <a href="https://www.w3.org/TR/webauthn-2/" 
title="Web Authentication">Web&nbsp;Authentication<img src="images/xtl.svg" alt="link"></a> enrollment system.
    The extension would enable the <span class="actor">Browser</span> 
to securely distinguish between &quot;ordinary&quot; FIDO keys,
    and those targeted for payments which is required for maintaining
 a <i>database</i> in the <span class="actor">Browser</span> holding FWP credentials.
  </div>
  <div class="para">
    It would be great if the enrollment system could handle
  <i>multiple credentials in a single operation</i>, because an <span class="actor">Issuer</span> may want to
    support international card networks as well as national or regional payment networks 
    <span style="font-family:Roboto,sans-serif,Segoe UI">&#x1f60e;</span>
  </div>
  <div class="para">
    It MAY be technically feasible using a FIDO key associated with an FWP credential
for Web Authentication as well, but this would be a deployment decision
by the <span class="actor">Issuer</span>.
  </div>
  <div id="wallet" class="para box comment">
    FWP effectively forms a browser &quot;Wallet&quot;,
    holding an arbitrary number of payment credentials, each representing a
    specific <span class="actor">Issuer</span>,
    <span class="actor">User</span> account,
    and <code>paymentMethod</code>.
  </div>
  <div id="operation" class="header">
    Detailed Operation
  </div>
  <div>This section describes the different steps needed to authorize a payment operation using FWP.
   To improve readability, JSON data is pretty-printed.
</div>
  <div class="para">
    Note that JSON data types are <i>implicitly</i> provided only (through sample objects).
  </div>
<div class="para">
  The foundation for the description is the following sequence diagram <i>sample</i>
  where each step is linked to a <i>clickable</i> number in a box:
</div>
  <div style="overflow-x:auto;padding:8pt 0">
    @sequencediagram@
  </div>
<div>Note that the <i>normative</i> part of this specification only covers the 
    steps within the dotted rectangle. That is, how FWP implements
   the <a href="https://www.w3.org/TR/payment-request/"
   title="PaymentRequest">PaymentRequest<img src="images/xtl.svg" alt="link"></a>
   interface.</div>
<div class="step"><div id="seq-1" class="numbox">1</div>Initiate PaymentRequest</div>
<div>
  At this point the <b class="actor">User</b> is assumed to have clicked on
  a &quot;Buy&quot; button (after first having selected an FWP compliant payment method),
  causing a <b class="actor">Merchant</b> Web page to invoke 
  a custom doPaymentRequest() method, like in the following sample:
</div>
<pre class="box">
// FWP sample code

const methodData = [{
  supportedMethods: "fido-web-pay/v1",
  data: {
    payee: "Space Shop",  // Shown in the UI
    networks: [{
      name: "https://emvco.com/fwp/mastercard"
    },{
      name: "https://emvco.com/fwp/visa"
    },{
      name: "https://europeanpaymentsinitiative.eu/fwp",
      networkData: "additional stuff..."
    }]
  }
}];

const request = new PaymentRequest(methodData, {
  id: "7040566321",   // Mandatory for FWP
  total: {label: null, amount: {currency: "EUR", value: "435.00"}}
});

async function doPaymentRequest() {
  const response = await request.show();
  await response.complete("success");
  return response.details;
}
</pre>
<div>
  When the <code>PaymentRequest.show()</code> method is invoked, the <span class="actor">Browser</span>
  (FWP implementation) MUST perform the following checks:
</div>
<ul>
  <li>
    There is an accompanying <code>data</code> attribute holding a
    <i>JSON-serializable</i> JavaScript <kbd>Object</kbd>.
  </li>
  <li>
    The <code>data</code> object contains a <code>payee</code>
    attribute holding a <i>non-empty</i> JavaScript <kbd>String</kbd> argument.
  </li>
  <li>
    The <code>data</code> object contains a <code>networks</code>
    attribute holding a JavaScript <kbd>Array</kbd> argument.
  </li>
  <li>
    The <code>networks</code> array holds a <i>non-empty</i> list of
    JavaScript <kbd>Object</kbd>s.
  </li>
  <li>
    That each object in the <code>networks</code> array contains a <code>name</code>
    attribute holding a <i>non-empty</i> JavaScript <kbd>String</kbd> argument.
  </li>
  <li>
    That none of the objects in the <code>networks</code> array contain other
    attributes, with the exception of an <i>optional</i> <code>networkData</code>
    attribute holding arbitrary JavaScript data.
  </li>
  <li>
    There is only <i>one</i> <code>PaymentItem</code> and it has a
    <code>label</code> attribute with the argument <kbd>null</kbd>.
  </li>
  <li>
    There is a <i>non-empty</i> <code>id</code> argument included in the
    <code>details</code> parameter to the <code>PaymentRequest</code> constructor.
  </li>
</ul>
<div class="para">Any deviations MUST throw an exception.</div>
<div class="para">Note that the <code>name</code> properties in the <code>networks</code>
array denote the actual payment methods, corresponding to the <code>paymentMethod</code>
attribute in <a href="#credentials">FWP credentials</a>.</div>
<div class="para">
  Note that the <code>PaymentRequest.canMakePayment()</code> method MUST return <kbd>true</kbd>
if the <span class="actor">User</span> have one or more FWP credentials,
regardless if they match the associated <code>PaymentRequest</code> list or not;
else it MUST return <kbd>false</kbd>.
</div>
<div class="step"><div id="seq-2" class="numbox">2</div>Show Payment Authorization UI</div>
  <div style="margin-bottom:0.8em">
    After successful invocation of the <code>PaymentRequest.show()</code>
    method, the <b class="actor">Browser</b> responds with
    a payment authorization UI like the following:
  </div>
  <div style="overflow-x:auto;padding-bottom:5pt">
    <img style="display:block;width:220pt;box-shadow:2pt 2pt 3pt #808080;border-width:1pt;border-style:solid;border-color:darkgrey" alt="Payment UI" src="images/ui.svg">
  </div>
  <div>Non-normative UI in &quot;dark mode&quot;.</div>
  <div class="para">
    If the <b class="actor">User</b> has no matching payment credentials,
    the <b class="actor">Browser</b> MUST indicate that and give the <b class="actor">User</b>
    an option to return to the <b class="actor">Merchant</b> &quot;Checkout&quot; page.
  </div>
  <div class="para">
    If the <b class="actor">User</b> has multiple matching payment credentials,
    the <b class="actor">Browser</b> MUST provide a way to select a specific credential.
    In the sample UI shown above, the <b class="actor">User</b>
    can swipe credentials to the left and right, while arrow symbols are used to show if there
    are more credentials available.  That is, if there is no left arrow, the credential selector is
    at the left end point.
  </div>
   <div class="para">
    If a selected credential is associated with an <i>external</i> token which is currently not
    available, the <b class="actor">User</b> should be asked to insert it.
  </div>
<div class="step"><div id="seq-3" class="numbox">3</div>Perform User Authorization</div>
<div>
At this point the <b class="actor">User</b>
<i>authorizes</i> the request with a fingerprint, PIN, or similar.
A successful user authorization causes the next step to be performed.
</div>
<div class="step"><div id="seq-4" class="numbox">4</div>Create FWP Assertion</div>
<div>
At this point the <b class="actor">Browser</b>
creates an FWP assertion which requires the following steps to be performed:
</div>
<div id="seq-4.1" class="step">4.1 Extract PaymentRequest Core Data (PRCD)</div>
<div class="para">
  Create a JSON object representing the core payment request data supplied
  by the <b class="actor">Merchant</b>.  For the sample code this should
  result in the following object:
</div>
<pre class="box">
{
  "id": "7040566321",
  "payee": "Space Shop",
  "amount": {
    "currency": "EUR",
    "value": "435.00"
  }
}
</pre>
<div>Description:</div>
<table class="tftable">
  <tr><th>Attribute</th><th>Data</th></tr>
  <tr>
    <td><code>id</code></td>
    <td>
      <b class="actor">Merchant</b> transaction ID. Copy of <code>details.id</code>.
    </td>
  </tr>
  <tr>
    <td><code>payee</code></td>
    <td>
      <b class="actor">Merchant</b> common name.
    </td>
  </tr>
  <tr>
    <td><code>amount</code></td>
    <td>
      Amount of money requested by the <b class="actor">Merchant</b>.
    </td>
  </tr>
</table>
<div>
  This object is subsequently referred to as PaymentRequest Core Data (PRCD).
</div>
<div id="seq-4.2" class="step">4.2 Create a Hash of PaymentRequest Core Data (PRCDHASH)</div>
<div class="para">
  Calculate a Base64Url-encoded SHA256 hash of PRCD, canonicalized according to
  <a href="https://tools.ietf.org/html/rfc8785"
      title="JCS/RFC8785">RFC8785<img src="images/xtl.svg" alt="link"></a>.
  The resulting string is subsequently referred to as PRCDHASH.
</div>
<div class="para">
  Expressed as a formula: PRCDHASH = BASE64URL(SHA256(RFC8785(PRCD))).
</div>
<div class="para">
  Applied to the sample data, this operation should return "-5AfYJfNayqcxJs2nqkUm7EKKLS1oPumgWNWc1BCPuQ".
</div>
<div id="seq-4.3" class="step">
  4.3 Create Authorization Data (AD)
</div>
<div class="para">
  Create a JSON object representing the data to authorize.
  For the sample code this should result in the following object:
</div>
<pre class="box">
{
  "version": "1",
  "requestHash": {
    "algorithm": "S256",
    "value": "-5AfYJfNayqcxJs2nqkUm7EKKLS1oPumgWNWc1BCPuQ"
  },
  "payeeHost": "spaceshop.com",
  "accountId": "FR7630002111110020050014382",
  "paymentMethod": "https://europeanpaymentsinitiative.eu/fwp",
  "networkData": "additional stuff...",
  "credentialId": "62932",
  "userAuthorizationMethod": "FINGERPRINT",
  "platformData": {
    "operatingSystem": {
      "name": "Android",
      "version": "10"
    },
    "userAgent": {
      "name": "Chrome",
      "version": "95"
    }
  },
  "timeStamp": "2021-03-09T10:32:35+01:00"
}
</pre>
<div>Description:</div>
<table class="tftable">
  <tr><th>Attribute</th><th>Data</th></tr>
  <tr>
    <td><code>version</code></td>
    <td>
      FWP assertion data version.  This specification covers version &quot;1&quot;.
    </td>
  </tr>
  <tr>
    <td><code>requestHash</code></td>
    <td>
      PRCDHASH and associated hash algorithm.
    </td>
  </tr>
  <tr>
    <td><code>payeeHost</code></td>
    <td>
      Host name as interpreted by the <b class="actor">Browser</b>.
      Included for optional validation by the <b class="actor">Issuer</b>,
      aided by the <b class="actor">PSP</b>.
    </td>
  </tr>
  <tr>
    <td><code>accountId</code></td>
    <td>
      <b class="actor">User</b> account number associated
      with the selected <a href="#credentials">FWP credential</a>.
    </td>
  </tr>
  <tr>
    <td><code>paymentMethod</code></td>
    <td>
      Payment method associated with the selected <a href="#credentials">FWP credential</a>.
      Included for &quot;completeness&quot;.
    </td>
  </tr>
  <tr>
    <td><code>networkData</code></td>
    <td>
      <i>Optional</i>.  This attribute MUST be included if
      specified in the <code>PaymentRequest</code> constructor
      for the particular <code>paymentMethod</code>, otherwise it MUST NOT be defined.
    </td>
  </tr>
  <tr>
    <td><code>credentialId</code></td>
    <td>
      Credential identifier associated with the selected <a href="#credentials">FWP credential</a>.
    </td>
  </tr>
  <tr>
    <td><code>userAuthorizationMethod</code></td>
    <td>
      Currently FINGERPRINT, FACERECOGNITION, and PIN are supported.
      Included for <i>security and logging</i> purposes.
    </td>
  </tr>
  <tr>
    <td><code>platformData</code></td>
    <td>
      Up-to-date information about the core <i>software</i> components.
      <i>Device data</i> is assumed to be established during credential enrollment.
      Included for <i>security and logging</i> purposes.
    </td>
  </tr>
  <tr>
    <td><code>timeStamp</code></td>
    <td>
      ISO (<a href="https://tools.ietf.org/html/rfc3339"
              title="RFC3399">RFC3399<img src="images/xtl.svg" alt="link"></a>)
      time stamp generated by the FWP implementation.
      If the local time zone is known, it SHOULD be included.
    </td>
  </tr>
</table>
<div>
  This object is subsequently referred to as Authorization Data (AD).
</div>

<div id="seq-4.4" class="step">4.4 Create Signed Authorization Data (SAD)</div>
<div class="para">
  Using the FIDO signature key (<code>keyHandle</code>) associated with the selected
  <a href="#credentials">FWP credential</a>, sign AD using the
  <a href="https://tools.ietf.org/html/draft-jordan-jws-ct-02"
     title="JWS/CT">JWS/CT<img src="images/xtl.svg" alt="link"></a> method.
  For the sample code this should result in the following object:
</div>
<pre class="box">
{
  "version": "1",
  "requestHash": {
    "algorithm": "S256",
    "value": "-5AfYJfNayqcxJs2nqkUm7EKKLS1oPumgWNWc1BCPuQ"
  },
  "payeeHost": "spaceshop.com",
  "accountId": "FR7630002111110020050014382",
  "paymentMethod": "https://europeanpaymentsinitiative.eu/fwp",
  "networkData": "additional stuff...",
  "credentialId": "62932",
  "userAuthorizationMethod": "FINGERPRINT",
  "platformData": {
    "operatingSystem": {
      "name": "Android",
      "version": "10"
    },
    "userAgent": {
      "name": "Chrome",
      "version": "95"
    }
  },
  "timeStamp": "2021-03-09T10:32:35+01:00",
  "signature": "eyJhbGciOiJFUzI1NiJ9..5WaPL_S0zLIAzkptti7CxdAqXtgosdG2lUWoELuy3ONSWUGJC5vxnkcdA0jYsebcomHpfpsmO5Y6IcZ8bBdvQA"
}
</pre>
<div>
  This operation adds a single attribute (<code>signature</code>) to AD.
</div>
<div class="para">  The resulting object is subsequently referred to as Signed Authorization Data (SAD).</div>
<div class="para">
  <span style="color:red">
    NOTE: The current FIDO authenticator API (CTAP2)
    <i>is not compatible with JWS</i>,
    which may require a slightly modified way dealing with the inner part of JWS/CT:
  </span>
  <a href="https://github.com/w3c/webauthn/issues/1581"
     title="GitHub Issue">https://github.com/w3c/webauthn/issues/1581<img src="images/xtl.svg" alt="link"></a>.
</div>

<div class="para">
  To simplify backend processing, the <code>publicKey</code> associated with
  the selected <a href="#credentials">FWP credential</a> MUST be included in the JWS header.
  In the sample the following key was used:
</div>
<pre class="box">
{
  "kty": "EC",
  "crv": "P-256",
  "x": "6BKxpty8cI-exDzCkh-goU6dXq3MbcY0cd1LaAxiNrU",
  "y": "mCbcvUzm44j3Lt2b5BPyQloQ91tf2D2V-gzeUxWaUdg"
}
</pre>
<div id="seq-4.5" class="step">4.5 Create Encrypted Signed Authorization Data (ESAD)</div>
<div class="para">
  For privacy and security reasons, Signed Authorization Data (SAD) objects
  MUST be encrypted by a public key provided by the <b class="actor">Issuer</b>
  through the <code>encryptionKey</code> attribute of the selected 
  <a href="#credentials">FWP credential</a>.
  This specification mandates using JWE
  (<a href="https://tools.ietf.org/html/rfc7516"
      title="JWE">RFC7516<img src="images/xtl.svg" alt="link"></a>),
  in the compact serialization mode. The selection between
  RSA or ECDH encryption schemes is at the discretion of the <b class="actor">Issuer</b>.
</div>
<div class="para">
  The actual JWE algorithms to use are defined by the
  <code>contentEncryptionAlgorithm</code> and 
  <code>keyEncryptionAlgorithm</code> attributes 
  of the selected <a href="#credentials">FWP credential</a>.
</div>
<div class="para">
  SAD objects MUST be JSON-serialized to UTF-8 before being encrypted.
  The resulting JWE string would look something like this
  (with line breaks for display purposes only):
</div>
<pre class="box">
eyJhbGciOiJSU0EtT0FFUCIsImVuYyI6IkEyNTZHQ00ifQ.OKOawDo13gRp2oja
HV7LFpZcgV7T6DVZKTyKOMTYUmKoTCVJRgckCL9kiMT03JGeipsEdY3mx_etLbb
WSrFr05kLzcSr4qKAq7YN7e9jwQRb23nfa6c9d-StnImGyFDbSv04uVuxIp5Zms
1gNxKKK2Da14B8S4rzVRltdYwam_lDp5XnZAYpQdb76FdIKLaVmqgfwX7XWRxv2
322i-vDxRfqNzo_tETKzpVLzfiwQyeyPGLBIO56YJ7eObdv0je8860ppamavo35
UgoRdbYaBcoh9QcfylQr66oc6vFWXRcZ_ZT2LawVCWTIy3brGPi6UklfCpIMfIj
f7iGdXKHzg.48V1_ALb6US04U3b.5eym8TW_c8SuK0ltJ3rpYIzOeDQz7TALvtu
6UG9oMo4vpzs9tX_EFShS8iB7j6jiSdiwkIr3ajwQzaBtQD_A.XFBoMYUZodetZ
dvTiFvSkQ
</pre>
<div>
  This object is subsequently referred to as Encrypted Signed Authorization Data (ESAD).
</div>
<div class="para">
  Note that the JWE header MUST include the <code>encryptionKey</code> as well.
</div>
<div id="domainconstraints" class="para box comment">
  Due to the end-to-end encryption scheme, the domain 
  constraints associated with Web Authentication
  assertions do not apply.
</div> 

<div id="seq-4.6" class="step">4.6 Assemble FWP Assertion</div>
<div class="para">
  Create a JSON-serializable JavaScript object representing an <span class="msg">FWP Assertion</span>.
  For the sample code this should result in the following object,
  here shown in its serialized form:
</div>
<pre class="box">
{
  "encryptedAuthorization": <i>"ESAD"</i>,
  "paymentMethod": "https://europeanpaymentsinitiative.eu/fwp",
  "issuerId": "https://mybank.fr/payment"
}
</pre>
<div>Description:</div>
<table class="tftable">
  <tr><th>Attribute</th><th>Data</th></tr>
  <tr>
    <td><code>encryptedAuthorization</code></td>
    <td>
      Encrypted Signed Authorization Data.
      Here shown as a placeholder only since
      an ESAD string can be quite long.
    </td>
  </tr>
  <tr>
    <td><code>paymentMethod</code></td>
    <td>
      Payment method associated with the selected <a href="#credentials">FWP credential</a>.
    </td>
  </tr>
  <tr>
    <td><code>issuerId</code></td>
    <td>
      Issuer identifier associated with the selected <a href="#credentials">FWP credential</a>.
    </td>
  </tr>
</table>
<div>
  The <span class="msg">FWP Assertion</span> is made available
  to the <code>PaymentRequest</code> invocation code via the
<code>PaymentResponse.details</code> attribute.
</div>
<div id="servicediscovery" class="comment box">
  An alternative to using <code>issuerId</code> attributes for service
  end-points, is populating <code>issuerId</code> attributes with <i>Service Discovery URLs</i>,
  which in turn provide the actual service end-points (as well as other information
  that may be required to have <i>before</i> service invocation).
</div> 
<div class="step"><div id="seq-5" class="numbox">5</div>Send FWP Assertion</div>
<div>
  At this point the checkout Web code would normally
  send the completed <span class="msg">FWP Assertion</span> to the
  <b class="actor">Merchant</b> server through a FORM&nbsp;POST
or <code>fetch()</code> operation.
</div>
<div class="step"><div id="seq-6" class="numbox">6</div>Process FWP Assertion and Create PSPRequest Object</div>

<div>
  After receiving the <span class="msg">FWP Assertion</span>,
  the <b class="actor">Merchant</b> would usually call a
  <b class="actor">PSP</b> with a specifically crafted object.
  The exact definition is likely to be specific for each <b class="actor">PSP</b> network
  and is therefore out of scope for this specification.
  The following <i>sample</i> outlines such an object:
</div>
<pre class="box">
{
  "paymentRequest": {
    "id": "7040566321",
    "payee": "Space Shop",
    "amount": {
      "currency": "EUR",
      "value": "435.00"
    }
  },
  "encryptedAuthorization": <i>"ESAD"</i>,
  "paymentMethod": "https://europeanpaymentsinitiative.eu/fwp",
  "issuerId": "https://mybank.fr/payment"
  "networkData": "additional stuff...",
  "receiveAccount": "DE89370400440532013000",
  "clientIp": "220.13.198.144",
  "timeStamp": "2021-03-09T10:32:36+01:00"
}
</pre>
  <div>Description:</div>
  <table class="tftable">
    <tr><th>Attribute</th><th>Data</th></tr>
    <tr>
      <td><code>paymentRequest</code></td>
      <td>
        Copy of <a href="#seq-4.1">PRCD</a>, <i>recreated</i> by the <b class="actor">Merchant</b>.
      </td>
    </tr>
    <tr>
      <td><code>encryptedAuthorization</code></td>
      <td>
        Copy of the same attribute in the <a href="#seq-4.6">FWP Assertion</a>.
      </td>
    </tr>
    <tr>
      <td><code>paymentMethod</code></td>
      <td>
        Copy of the same attribute in the <a href="#seq-4.6">FWP Assertion</a>.
      </td>
    </tr>
    <tr>
      <td><code>issuerId</code></td>
      <td>
        Copy of the same attribute in the <a href="#seq-4.6">FWP Assertion</a>.
      </td>
    </tr>
    <tr>
      <td><code>networkData</code></td>
      <td>
        <i>Optional</i>.  See <a href="#seq-4.3">Authorization Data</a>.
      </td>
    </tr>
    <tr>
      <td><code>receiveAccount</code></td>
      <td>
        <b class="actor">Merchant</b> account to be credited.
      </td>
    </tr>
    <tr>
      <td><code>clientIp</code></td>
      <td>
        Request IP address (in V4 or V6 format) of the <b class="actor">User</b> device.
        Included for <i>security and logging</i> purposes.
      </td>
    </tr>
    <tr>
      <td><code>timeStamp</code></td>
      <td>
        ISO time stamp generated by the <b class="actor">Merchant</b>.
      </td>
    </tr>
  </table>
  <div class="step">
    <div id="seq-7" class="numbox">7</div>Send PSPRequest Object
  </div>
  <div>
    At this point the <b class="actor">Merchant</b> sends the completed <span class="msg">PSPRequest</span>
    object to the appropriate <b class="actor">PSP</b>.
  </div>
  <div class="para">
    Note that authentication of the <b class="actor">Merchant</b> is out of scope
    for this specification.
  </div>
  <div id="pspselection" class="comment box">
    Since FWP supports <i>multiple</i> and <i>independent</i> payment systems,
    a <b class="actor">Merchant</b> may use different <b class="actor">PSP</b>s
    depending on received <code>paymentMethod</code>.
  </div>
  <div class="step">
    <div id="seq-8" class="numbox">8</div>Process PSPRequest and Create IssuerRequest Object
  </div>
  <div>
    After successfully having authenticated the <b class="actor">Merchant</b> request,
    the <b class="actor">PSP</b> MUST perform a number of checks on the
    received object including:
  </div>
  <ul>
    <li>
      That <code>paymentRequest</code> is properly formatted and that
      the <code>payee</code> attribute
      matches the <b class="actor">Merchant</b> common name registered with the <b class="actor">PSP</b>.
    </li>
    <li>
      That the <code>paymentMethod</code> is supported.
    </li>
    <li>
      That the format of the <code>issuerId</code> matches <code>paymentMethod</code>.
    </li>
    <li>
      That the <code>receiveAccount</code> matches a <b class="actor">Merchant</b> account
      registered with the <b class="actor">PSP</b>.
    </li>
    <li>
      That the <code>timeStamp</code> is within &quot;reasonable limits&quot;.
    </li>
    <li>
      That the rest of the expected parameters are available as well that there are no unknown attributes.
    </li>
  </ul>
  <div class="para">
    Any deviations MUST cause the request to be rejected.
    Fault handling is out of scope for this specification.
  </div>
  <div class="para">
    The next step is creating a suitable <span class="msg">IssuerRequest</span> object.
    The exact definition is likely to be specific for each payment network and 
    is therefore out of scope for this specification.
    The following <i>sample</i> outlines such an object:
  </div>
  <pre class="box">
{
  "pspRequest": {
    "paymentRequest": {
      "id": "7040566321",
      "payee": "Space Shop",
      "amount": {
        "currency": "EUR",
        "value": "435.00"
      }
    },
    "encryptedAuthorization": <i>"ESAD"</i>,
    "paymentMethod": "https://europeanpaymentsinitiative.eu/fwp",
    "issuerId": "https://mybank.fr/payment"
    "networkData": "additional stuff...",
    "receiveAccount": "DE89370400440532013000",
    "clientIp": "220.13.198.144",
    "timeStamp": "2021-03-09T10:32:36+01:00"
  },
  "payeeHost": "spaceshop.com",
  "timeStamp": "2021-03-09T10:32:37+01:00"
}
</pre>

  <div>Description:</div>
  <table class="tftable">
    <tr><th>Attribute</th><th>Data</th></tr>
    <tr>
      <td><code>pspRequest</code></td>
      <td>
        Copy of the <a href="#seq-6">PSPRequest</a> object
        received from the <b class="actor">Merchant</b>.
      </td>
    </tr>
    <tr>
      <td><code>payeeHost</code></td>
      <td>
        The <b class="actor">Merchant</b> host name registered by the <b class="actor">PSP</b>.
      </td>
    </tr>
    <tr>
      <td><code>timeStamp</code></td>
      <td>
        ISO time stamp generated by the <b class="actor">PSP</b>.
      </td>
    </tr>
  </table>
  <div class="step">
    <div id="seq-9" class="numbox">9</div>Send IssuerRequest Object
  </div>
  <div>
    At this point the <b class="actor">PSP</b> sends the completed <span class="msg">IssuerRequest</span>
    object to the designated <b class="actor">Issuer</b>.
    Note that the method used for locating the proper <b class="actor">Issuer</b> depends on
    the <code>paymentMethod</code> and <code>issuerId</code> attributes.
    In the sample the <span class="msg">IssuerRequest</span> object
    would presumably be sent to <span class="msg">https://mybank.fr/payment</span>.
  </div>
  <div class="step">
    <div id="seq-10" class="numbox">10</div>Process IssuerRequest
  </div>
  <div>
    Before initiating a payment transaction the <b class="actor">Issuer</b>
    MUST decode and perform a number of steps to verify the
    correctness of the received <span class="msg">IssuerRequest</span> object.
    Any deviation MUST terminate the operation in progress and return an
    error message to the <b class="actor">PSP</b> in a not here specified manner.
</div>
 <div id="seq-10.1" class="step">
    10.1 Core Validation.
 </div>
 <ul>
   <li>
     Verify that <span class="msg">IssuerRequest</span> schema-wise is properly formatted.
   </li>
   <li>
     Verify that the <code>timeStamp</code> is within &quot;reasonable limits&quot;.
   </li>
   <li>
     Verify that the <code>pspRequest.paymentMethod</code> is supported.
   </li>
   <li>
     Verify that the <code>pspRequest.receiveAccount</code> 
is compatible with the <code>pspRequest.paymentMethod</code>.
   </li>
   <li>
     Verify that the <code>pspRequest.issuerId</code> 
is compatible with the <code>pspRequest.paymentMethod</code>
     as well as matching the <b class="actor">Issuer</b>.
   </li>
 </ul>

<div id="seq-10.2" class="step">
10.2 Decode and Verify PaymentRequest Core Data (PRCD)
</div>
<ul>
<li>
  Verify that <code>pspRequest.paymentRequest</code> 
represents a valid <a href="#seq-4.1">PRCD</a> object.
</li>
<li>
  Calculate a <a href="#seq-4.2">PRCDHASH</a> string of the 
<code>pspRequest.paymentRequest</code> data.
</li>
</ul>
<div id="seq-10.3" class="step">
  10.3 Extract Signed Authorization Data (SAD)
</div>
<ul>
<li>
Decode the JWE compatible <a href="#seq-4.5">ESAD</a> string supplied in 
<code>pspRequest.encryptedAuthorization</code>.
</li>
<li>
Verify that the public key declared in the JWE header matches an
existing decryption (private) key of the <b class="actor">Issuer</b>.
</li>
<li>
Decrypt the ESAD string using the private key retrieved in the previous operation.
</li>
<li>
Parse the result of the previous operation as JSON and set result as <a href="#seq-4.4">SAD</a>.
</li>
<li>
Verify that the SAD object schema-wise has the proper format.
</li>
</ul>
<div id="seq-10.4" class="step">
  10.4 Validate Request Data
</div>
<ul>
<li>
Verify that <code>SAD.version</code> is supported.
</li>
<li>
Verify that the previously calculated PRCDHASH is equivalent to <code>SAD.requestHash.value</code>.
That is, verifying that the <b class="actor">Merchant</b> payment claim corresponds to what the
<b class="actor">User</b> have actually <i>seen and authorized</i>.
</li>
<li>
Verify that <code>pspRequest.payeeHost</code> is equivalent to <code>SAD.payeeHost</code>.
That is, verifying that the <b class="actor">User</b> was not subject to phishing.
Note that phishing attacks against FWP are not useful for stealing money,
but for redirecting purchased goods to another address.
</li>
<li>
  Verify that the <code>SAD.timeStamp</code> is within &quot;reasonable limits&quot;.
  <i>Tentative:</i> CurrentTime - 600s &lt; <code>SAD.timeStamp</code> &lt; CurrentTime + 60s.
</li>
<li>
Verify that the <i>optional</i> <code>SAD.networkData</code> attribute complies 
with the <b class="actor">Issuer</b> specific requirements.
</li>
</ul>

<div id="seq-10.5" class="step">
  10.5 Validate Authorization Signature
</div>
<ul>
<li>
Verify the JWS/CT signature of the recovered SAD object.
Since the public key is included in the JWS header, signature validation 
does not require database lookups.
</li>
<li>
Verify that the aforementioned public key is linked to a <b class="actor">User</b>
account matching the <code>SAD.accountId</code> and <code>SAD.credentialId</code> attributes
(where <code>SAD.credentialId</code> would typically serve as the primary key in a credential database table). 
Note that this check requires that the
public key first is converted into a <i>canonical format</i> like JWK &quot;thumbprint&quot;
(<a href="https://tools.ietf.org/html/rfc7638"
   title="JWK thumbprint">RFC7638<img src="images/xtl.svg" alt="link"></a>).
</li>
</ul>
<div id="seq-10.6" class="step">
  10.6 Replay Handling
</div>
<div>
  To cope with possible replays, verify that the received <b class="actor">User</b> authorization
  has not already been used. This can be accomplished by maintaining a lookup cache
  holding SHA256 hashes of canonicalized (<a href="https://tools.ietf.org/html/rfc8785"
   title="JCS/RFC8785">RFC8785<img src="images/xtl.svg" alt="link"></a>) <a href="#seq-4.4">SAD</a> objects,
  associated with <i>successfully</i> processed requests.
  Cached items would be removed based on their <code>SAD.timeStamp</code> value.
</div>
<div class="para">
  Ideally, <b class="actor">Issuer</b>s
  SHOULD support <i>idempotent operation</i> to facilitate transaction retries
  that may happen due to network glitches or similar.
</div>
<div class="step">
  Other Validation Steps
</div> 
<div>
Obviously there are other things to verify but these are not directly related to FWP,
like checking that the <b class="actor">User</b> has funds available matching the
current request.
</div>
 <div id="integration" class="header">
    Integration
  </div>
  <div>
    It is pretty clear that the integration of systems like FWP in payment networks
    is crucial for acceptance by the market.
  </div>
  <div class="para">
    For card based payments FWP implementations can build on the existing
    EMV foundation since essentially only the formats differ.
    Although the lack of a PAN (card number) in FWP may appear as a major obstacle,
    the <code>issuerId</code> would in this case hold a &quot;neutered&quot; PAN where
    the BIN (Bank Identification Number) is set, while the rest are set to zeroes + Luhn check digit.
    E.g. VISA: 4972039000000004.  However, using <b class="actor">Issuer</b> URLs
    is also a viable alternative for card payments because payment processors
    associated with &quot;regular&quot; EMV and FWP payments would probably not
    share end points.
  </div>
  <div class="para">
    For account-to-account payments there are currently no generally agreed upon standards
    for consumer payments, but remapping existing card based systems and infrastructures
    seems though like a possible path.
  </div>
  <div class="para">
    <a href="#delegatedauthorization">Delegated Authorization</a> 
    represents yet another way addressing payment system integration.
  </div>

  <div id="delegatedauthorization" class="header">
    Delegated Authorization
  </div>
<div>
Using delegated authorization the validation
of <b class="actor">User</b> authorizations is separated 
from payment initiations. The purpose with such arrangements include:
</div>
<ul>
  <li>Potentially ease the integration of FWP in existing payment systems.</li>
  <li>Open the possibility <i>outsourcing</i> the authorization process to TPPs.</li>
</ul>
<div class="para">
  Note that FWP makes the use of delegated authorization <i>transparent</i>
  for both the <b class="actor">User</b> and the <b class="actor">Merchant</b>.
</div>
<div class="para">
  Delegated authorization differs from
  <a href="https://www.emvco.com/emv-technologies/3d-secure/"
     title="3DS Site">3D&nbsp;Secure<img src="images/xtl.svg" alt="link"></a>
  by keeping the validation process inside of the core payment network.
  This enables validation of potentially <i>untrusted</i> <b class="actor">Merchant</b>
  data as well as eliminating dependencies on certified <b class="actor">Merchant</b>
  3D&nbsp;Secure SDKs.
</div>
<div class="para">
  Delegated authorization builds on the assumption that the <b class="actor">PSP</b> is trusted
  for carrying out payment initiations on behalf of a <b class="actor">User</b>
  (based on a preceding <b class="actor">User</b> authorization step),
  which is an established concept in most payment networks.
  (In the FWP standard mode the <b class="actor">PSP</b> only acts as a proxy
  for the <b class="actor">Merchant</b>).
</div>
 <div class="para">
  The delegated authorization mode is illustrated by the following sequence diagram:
</div>
  <div style="overflow-x:auto;padding:8pt 0">
    @delegateddiagram@
  </div>
  <div>
    Note that step 1-7 are <i>identical</i> to the FWP &quot;standard&quot; mode. 
    &quot;Payment Rails&quot; refer to existing payment systems.
  </div>
 <div class="step"><div id="seq-D1" class="numbox">D1</div>Process PSPRequest and Create ValidateRequest Object</div>
 <div>
   This step should involve the same verifications as in <a href="#seq-8">step 8</a>
   in the standard mode.
   A suitable <span class="msg">ValidateRequest</span> object would typically follow the 
   <span class="msg">IssuerRequest</span> sample in step 8.
</div>
 <div class="comment box">
   Using delegated authorization may be decided by each <b class="actor">Issuer</b>
   <i>individually</i>.  The actual configuration is preferably resolved by making
   the <code>issuerId</code> attribute play the role of a <a href="#servicediscovery">Service Discovery URL</a>.
 </div>
 <div class="step"><div id="seq-D2" class="numbox">D2</div>Send ValidateRequest Object</div>
 <div>
   At this point the <b class="actor">PSP</b> sends the completed <span class="msg">ValidateRequest</span>
   object to the designated <b class="actor">Validator</b>.
   Note that the method used for locating the proper <b class="actor">Validator</b> depends on
   the <code>paymentMethod</code> and <code>issuerId</code> attributes.
 </div>
 <div class="step"><div id="seq-D3" class="numbox">D3</div>Process ValidateRequest</div>
 <div>
   This step should involve the same verifications as in <a href="#seq-10">step 10</a>
   in the standard mode.
 </div>
  <div class="step"><div id="seq-D4" class="numbox">D4</div>Return Validated Data</div>
  <div>
    If validation is successful, <span class="msg">ValidateRequest</span> 
    should return the decrypted <b class="actor">User</b> account number.
  </div>
  <div id="delegatedemv" class="comment box">
    A more sophisticated approach would be to return signed data for maintaining the
    end-to-end security model.  For card payments this would preferably be in the
   form of EMV compliant objects that can be passed on to existing payment systems
    &quot;as&nbsp;is&quot;.
  </div>
 <div class="step"><div id="seq-D5" class="numbox">D5</div>Create Payment Instruction</div>
 <div>
   After receiving the <b class="actor">User</b> account number a 
   <span class="msg">payment instruction</span> object is created.
   The format and contents of such objects are payment network specific and
   are therefore not described here.
</div>
 <div class="step"><div id="seq-D6" class="numbox">D6</div>Invoke &quot;Payment Rails&quot;</div>
  <div>
    Perform a <span class="msg">payment instruction</span> request in a payment network specific way.
  </div>
  <div class="step"><div id="seq-D7" class="numbox">D7</div>Process Payment Instruction</div>
  <div>
    Process the <span class="msg">payment instruction</span> request in a payment network specific way.
  </div>
  <div id="extensions" class="header">
    Extensions
  </div>
  <div>
    The FWP <i>client</i> is loosely derived from a proof-of-concept system called
    <a href="https://cyberphone.github.io/doc/saturn/"
       title="Saturn">Saturn<img src="images/xtl.svg" alt="link" /></a>.
    By continuing along this path, features like the following could potentially be added:
  </div>
  <ul>
    <li>
      Support for <i>non-direct payments</i>,
      including secure (<i>tokenized</i>) versions of Card-on-File.
    </li>
    <li>
      Support for real-time <i>account balances</i>.
    </li>
    <li>
      Support for <b class="actor">User</b> <i>refunding</i>.
    </li>
    <li>
      Support for universal <i>digital receipts</i>.
    </li>
    <li>
      Support for <i>private messaging</i> and additional authentication information between the
      <b class="actor">Issuer</b> and <b class="actor">User</b>.
    </li>
  </ul>
  <div class="para">
    Note that <i>some</i> of the features above could impact the PaymentRequest API.
  </div>
  <div id="implementationoptions" class="header">
    Implementation Options
  </div>
  <div>
    An alternative to building FWP support into browsers, is moving the FWP implementation 
    (including the <a href="#credentials">credential database</a>), down into the client platform layer.
    This would open FWP to other scenarios like:
  </div>
<ul style="margin-bottom:0.3em">
  <li>
    Point-of-sale (PoS) payments.
    This would (at least <i>initially</i>) depend on QR-code for invocation.
  </li>
  <li>
    Person-to-person (P2P) payments.
  </li>
</ul>
<div class="para">
  Such an arrangement would also introduce additional features including:
</div>
<ul>
  <li>
    Making it easier for alternative browser vendors adopting the FWP system
    since they would not have to build a copy of FWP themselves.
  </li>
  <li>
    Relieving users from having to enroll payment credentials
    for each browser they want to use.
  </li>
  <li>
    Limiting the number of systems to certify in the case certification
    becomes a requirement.
  </li>
</ul>
  <div id="acknowledgements" class="header">
    Acknowledgements
  </div>
  <div>
    The FWP core was heavily influenced by an earlier Microsoft research project
    called <a href="https://en.wikipedia.org/wiki/Windows_CardSpace"
              title="CardSpace">Windows CardSpace<img src="images/xtl.svg" alt="link"></a>.
  </div>
  <div class="para">
    The <b class="actor">User</b> icon was derived from
        <a style="word-break:break-all;white-space:normal"
 href="https://commons.wikimedia.org/wiki/File:Crystal_Clear_kdm_user_female.svg"
           title="User Icon">
https://commons.wikimedia.org/wiki/File:Crystal_Clear_kdm_user_female.svg<img src="images/xtl.svg" alt="link"></a></div>
  <div id="documenthistory" class="header">
    Document History
  </div>
  <table class="tftable">
    <tr><th>Date</th><th>Version</th><th>Comment</th></tr>
    <tr><td>2021-03-12</td><td>0.1</td><td>Initial publishing.</td></tr>
    <tr><td>2021-03-15</td><td>0.11</td><td>Added external token comment.</td></tr>
    <tr><td>2021-03-29</td><td>0.12</td><td>Improved replay handling + Changed &quot;Acquirer&quot; to &quot;PSP&quot;.</td></tr>
    <tr><td>2021-04-02</td><td>0.13</td><td>Added section Delegated Authorization.</td></tr>
    <tr><td>2021-04-11</td><td>0.14</td><td>Added credentialId + more text on the credential database.</td></tr>
    <tr><td>2021-04-14</td><td>0.15</td><td>Added section Implementation Options.</td></tr>
    <tr><td>2021-04-16</td><td>0.16</td><td>Added sequence diagram &quot;scope&quot; rectangle.</td></tr>
  </table>
  <div id="authors" class="header">
    Authors
  </div>
  <div>
    The FWP specification is currently authored by Anders Rundgren (anders.rundgren.net@gmail.com).<br />
  </div>
  <div class="header">
    Trademarks
  </div>
  <div id="trademarks">
    FIDO is a registered trademark of the FIDO alliance.<br />
    EMV is a registered trademark of EMVCo.<br />&nbsp;<br />
    This specification represents an <i>independent effort</i>, not associated with the FIDO alliance or EMVCo.
  </div>
</body></html>
