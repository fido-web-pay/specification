<!DOCTYPE html><html><head>
<meta charset='utf-8'><meta name='viewport' content='width=device-width, initial-scale=1'>
<link rel='icon' href='images/favicon.png' sizes='192x192'>
<title>FIDO Web Pay</title><style type='text/css'>
.header {font-size:1.5em;margin:1em 0 0.8em 0}
.para {margin-top: 0.8em}
.actor {color:darkgreen;font-weight:bolder}
.box {box-shadow: 0.2em 0.2em 0.2em #d0d0d0;border-width:1px;border-style:solid;border-color:black}
.numbox {border-width: 1pt;border-style:solid;border-color:black;border-radius:0.3em;display:inline-block;margin: 1.5em 0 0.6em 0;padding: 0 3pt 0.1em 3pt}
.tftable {border-collapse:collapse;box-shadow:0.3em 0.3em 0.3em #d0d0d0;margin-bottom:0.3em} 
.tftable td {white-space:nowrap;background-color:#ffffe0;padding:0.4em 0.5em;border-width:1px;border-style:solid;border-color:#a9a9a9}
.tftable th {white-space:nowrap;padding:0.4em 0.5em;background:linear-gradient(to bottom, #eaeaea 14%,#fcfcfc 52%,#e5e5e5 89%);text-align:center;border-width:1px;border-style:solid;border-color:#a9a9a9}
.json {word-break:break-all;background-color:#f8f8f8;padding:1em;border-width:1px;border-style:solid;border-color:#a9a9a9;box-shadow:0.3em 0.3em 0.3em #d0d0d0}
body {margin:1em;font-size:10pt;font-family:Verdana,'Bitstream Vera Sans','DejaVu Sans',Arial,'Liberation Sans';background-color:white} 
code {font-size:10pt}
.reserved {color:maroon;font-weight:bold}
ul {margin:0}
li {margin-top:0.3em}
a {color:blue;text-decoration:none}
</style>
</head>
<body>
  <img style='max-width:50%' src='images/fwp.svg' alt='logo' title='FWP logotype'>
  <div class='header'>FIDO&reg; Web Pay - Introduction</div>
  <div>
    <a href='https://www.emvco.com/' title='EMVCo Site'>EMV&reg;<img src='images/xtl.svg' alt='link'></a> represents
    the current &quot;Gold Standard&quot; for <i>secure and convenient payments</i>
    in the <u>Physical world</u>.
  </div>
  <div class='para'>
    This document describes FIDO Web Pay (FWP), which is a <u>Web-adapted</u> version of EMV,
    building on <a href='https://fidoalliance.org/fido2/' 
title='FIDO2 Technology'>FIDO2<img src='images/xtl.svg' alt='link'></a>
    technology combined with the W3C
    <a href='https://www.w3.org/TR/payment-request/' 
title='PaymentRequest'>PaymentRequest<img src='images/xtl.svg' alt='link'></a> API.
  </div>
  <div class='para'>
    However, unlike EMV, FWP is intended to be usable with <i>any account-based payment system</i>,
    including the eurozone's
    <a href='https://www.europeanpaymentscouncil.eu/' 
title='European Payments Council'>SEPA Instant<img src='images/xtl.svg' alt='link'></a>.
  </div>
  <div class='para'>
    Also in contrast to EMV, the FWP client <i>encrypts</i> user-authorizations to accomplish the following subgoals:
  <ul>
    <li>
      Eliminate dependencies on external tokenization services.
    </li>
    <li>
      Limit the amount of personally identifiable information (PII), shared
      with <i>third parties</i>, to the name of the payer's bank.
      This is presumably compliant with
      <a href='https://www.pcisecuritystandards.org'
         title='PCI Site'>PCI<img src='images/xtl.svg' alt='link'></a>
      requirements as well as with <a href='https://gdprinfo.eu/'
title='GDPR Site'>GDPR<img src='images/xtl.svg' alt='link'></a>.
    </li>
    <li>
      Separate the formats for account numbers and issuer (bank branch) identifiers.
      The latter would typically be expressed as URLs, removing the need for externally managed
      databases holding issuer payment processor end-points.
    </li>
  </ul>
</div>
  <div class='header'>
    Prerequisites
  </div>
  <div>
    The steps outlined in <a href='#operation'>Detailed Operation</a>
 depend on that the <span class='actor'>User</span> already has received
    one or more <i>payment credentials</i> in an <a href='#enrollment'>Enrollment</a> process.
    A payment credential is supposed to at least contain the following elements:
    <ul>
      <li>An identifier to a <span class='actor'>User</span> specific (<i>unique</i>) FIDO key for <i>signing</i> payment authorization data.</li>
      <li>An <span class='actor'>Issuer</span> specific (<i>shared</i>) public key for <i>encrypting</i> payment authorization data.</li>
      <li>An <code class='reserved'>accountId</code> associated with the FIDO signature key.</li>
      <li>A <code class='reserved'>paymentMethod</code> URL identifying the payment network.</li>
      <li>An <code class='reserved'>issuerId</code> in the form of a
Bank Identification Number (BIN) or URL associated with the <span class='actor'>Issuer</span>.</li>
      <li>An icon identifying the payment credential for the <span class='actor'>User</span>.</li>
    </ul>
  </div>
  <div class='para box' style='padding:0.5em 1em;margin-top:1em;display:inline-block'>
    Note that FWP effectively forms a browser-resident &quot;Wallet&quot;,
    holding any number of payment credentials, each representing a specific <span class='actor'>Issuer</span>
    and <code class='reserved'>paymentMethod</code>.
  </div>
  <div id='enrollment' class='header'>
    Credential Enrollment
  </div>
  <div>
    The exact enrollment process is yet to be defined; the assumption is that it
    could be accomplished by extending the existing W3C
    <a href='https://www.w3.org/TR/webauthn-2/' 
title='Web Authentication'>Web&nbsp;Authentication<img src='images/xtl.svg' alt='link'></a> enrollment system.
    The extension would enable the browser to securely distinguish between &quot;ordinary&quot; FIDO keys,
    and those targeted for payments.  This is needed for maintaining a local database holding FWP credentials.
  </div>
  <div class='para'>
    It MAY be technically feasible using a FIDO key associated with an FWP credential
for Web Authentication as well, but this would be a deployment decision
by the <span class='actor'>Issuer</span>.
  </div>
  <div id='operation' class='header'>
    Detailed Operation
  </div>
  <div>This section describes the different steps needed to perform a payment using FWP.
The foundation for the description is the following sequence diagram where each step
is linked to a <i>clickable</i> number in a box:
</div>
  <div style='overflow-x:auto;padding:8pt 0'>
    @statediagram@
  </div>
<div>Note that this specification does not elaborate on the return data from
the <b class='actor'>Acquirer</b> and <b class='actor'>Issuer</b>,
 because this is payment network specific.</div>
<div id='preq' class='numbox'>1</div>
<div>In this step the <b class='actor'>Merchant</b></div>
<div id='paymentui' class='numbox'>2</div>
<div>In this step the <b class='actor'>Merchant</b></div>
 <div id='userauth' class='numbox'>3</div>
<div>In this step the <b class='actor'>Merchant</b></div>
 <div id='fpwcore' class='numbox'>4</div>
<div>In this step the <b class='actor'>Merchant</b></div>
<div id='pres' class='numbox'>5</div>
<div>In this step the <b class='actor'>Merchant</b></div>
<div id='presproc' class='numbox'>6</div>
<div>In this step the <b class='actor'>Merchant</b></div>
<div id='areq' class='numbox'>7</div>
<div>In this step the <b class='actor'>Merchant</b></div>
<div id='areqproc' class='numbox'>8</div>
<div>In this step the <b class='actor'>Merchant</b></div>
<div id='ireq' class='numbox'>9</div>
<div>In this step the <b class='actor'>Merchant</b></div>
<div id='ireqproc' class='numbox'>10</div>
<div>In this step the <b class='actor'>Merchant</b></div>
<div id='paymentui' class='spacepara'>Core Receipt Data</div>
  <div style='overflow-x:auto;padding-bottom:5pt'>
    <img style='display:block;width:220pt;box-shadow:2pt 2pt 3pt #808080;border-width:1pt;border-style:solid;border-color:darkgrey' alt='Payment UI' src='images/ui.svg'>
  </div>
  <div>Non-normative UI in &quot;dark mode&quot;.</div>
  <div>
    <code>
      Core Receipt Data ghr 88 jj nl<br>
      ff<br>
      kk kjkhjkjkk yhjj jgj g hgh ghghg
    </code>
  </div>
  <div style='font-family:monospace'>
    Core Receipt Data ghr 88 jj nl<br>
    ff<br>
    kk kjkhjkjkk yhjj jgj g hgh ghghg</div>
<div id='extensions' class='header'>
Possible Extensions
</div>
<div>
The FWP core is loosely derived from a PoC system known as  
<a href='https://cyberphone.github.io/doc/saturn/' 
title='Saturn'>Saturn<img src='images/xtl.svg' alt='link' /></a>.
By building on this core, Saturn features like the following would be fairly easy to add:
<ul>
  <li>
    Support for <i>non-direct payments</i>,
    including secure (<i>tokenized</i>) versions of Card-on-File.
</li>
<li>
  Support for universal digital receipts.
</li>
<li>
  Support for private messaging and additional authentication information between the
 <b class='actor'>Issuer</b> and <b class='actor'>User</b>.
</li>
</ul>
</div>
<div class='para'>
A radical change would be moving the FWP implementation down into the client platform layer.
This would open FWP to other payment scenarios like point-of-sale (PoS) and person-to-person (P2P).
It would also make it easier for browser vendors adopting the FWP system.
</div>
<div id='version' class='header'>
  Author and Version
</div>
<div>
The FWP specification is currently authored by Anders Rundgren (<code>anders.rundgren.net@gmail.com</code>).<br/>
Document version: 0.1, 2020-03-09
</div>
<div class='header'>
  Trademarks
</div>
<div id='trademarks'>
  FIDO is a registered trademark of the FIDO alliance.<br/>
  EMV is a registered trademark of EMVCo.<br/>&nbsp;<br/>
  This specification represents an <i>independent effort</i>, not associated with the FIDO alliance or EMVCo.
</div>
</body></html>
